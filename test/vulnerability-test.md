# Vulnerability Testing Code Examples

Here are some safe, ethical examples of vulnerability testing code that you could use to test your own systems (with proper authorization):

## 1. Basic SQL Injection Test

```python
# Ethical SQL injection tester (for authorized testing only)
import requests

def test_sql_injection(url, params):
    """
    Test for basic SQL injection vulnerabilities
    """
    test_payloads = [
        "' OR '1'='1",
        "' OR 1=1 --",
        '" OR "" = "',
        "1; DROP TABLE users --"
    ]
    
    for payload in test_payloads:
        test_params = {k: payload for k in params.keys()}
        try:
            response = requests.get(url, params=test_params)
            if "error in your SQL syntax" in response.text.lower():
                print(f"Possible SQLi vulnerability with payload: {payload}")
            elif response.status_code == 500:
                print(f"Server error with payload: {payload} - investigate further")
        except Exception as e:
            print(f"Error testing payload {payload}: {str(e)}")

# Example usage (only test systems you own/have permission to test)
# test_sql_injection("http://your-test-site.com/login", {"username": "test", "password": "test"})
```

## 2. XSS Vulnerability Test

```javascript
// Ethical XSS tester (client-side version)
function testXSS(url) {
  const xssPayloads = [
    "<script>alert('XSS')</script>",
    "<img src=x onerror=alert('XSS')>",
    "<svg/onload=alert('XSS')>",
    "javascript:alert('XSS')"
  ];
  
  xssPayloads.forEach(payload => {
    const testUrl = `${url}?test=${encodeURIComponent(payload)}`;
    fetch(testUrl)
      .then(response => response.text())
      .then(text => {
        if (text.includes(payload.replace(/<|>/g, ''))) {
          console.warn(`Possible XSS vulnerability with payload: ${payload}`);
        }
      })
      .catch(error => console.error(`Test failed: ${error}`));
  });
}

// Example usage (only test systems you own):
// testXSS('http://your-test-site.com/search');
```

## 3. Directory Traversal Test

```python
# Ethical directory traversal tester
import requests

def test_directory_traversal(base_url):
    traversal_payloads = [
        "../../../../etc/passwd",
        "..%2F..%2F..%2Fetc%2Fpasswd",
        "....//....//etc/passwd"
    ]
    
    for payload in traversal_payloads:
        test_url = f"{base_url}?file={payload}"
        try:
            response = requests.get(test_url)
            if "root:" in response.text:
                print(f"CRITICAL: Possible directory traversal with payload: {payload}")
            elif response.status_code != 404:
                print(f"Unusual response with payload {payload} - status {response.status_code}")
        except Exception as e:
            print(f"Error testing payload {payload}: {str(e)}")

# Example usage:
# test_directory_traversal("http://your-test-site.com/download")
```

## 4. Basic Security Headers Check

```bash
#!/bin/bash
# Simple security headers checker

URL="http://example.com"  # Change to your test URL

echo "Testing security headers for $URL"
echo "-------------------------------"

headers=$(curl -I -s $URL | grep -iE "strict-transport-security|x-frame-options|x-xss-protection|x-content-type-options|content-security-policy")

if [[ -z "$headers" ]]; then
  echo "No security headers found!"
else
  echo "$headers"
fi

echo ""
echo "Checking for server information leaks..."
server_info=$(curl -I -s $URL | grep -iE "server|x-powered-by")

if [[ -n "$server_info" ]]; then
  echo "WARNING: Server information exposed:"
  echo "$server_info"
fi
```

## 5. CSRF Token Checker

```python
import requests
from bs4 import BeautifulSoup

def check_csrf_protection(url):
    try:
        session = requests.Session()
        response = session.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')
        
        csrf_token = soup.find('input', {'name': 'csrf_token'}) or \
                     soup.find('input', {'name': 'csrfmiddlewaretoken'}) or \
                     soup.find('input', {'name': '_token'})
        
        if csrf_token:
            print(f"CSRF token found (good): {csrf_token['name']}")
        else:
            print("WARNING: No CSRF token found in forms")
            
    except Exception as e:
        print(f"Error checking CSRF protection: {str(e)}")

# Example usage:
# check_csrf_protection("http://your-test-site.com/login")
```

## Important Ethical Considerations:

1. **Only test systems you own or have explicit permission to test**
2. **Never test production systems without authorization**
3. **Use a controlled environment for testing**
4. **Disclose any findings responsibly to the system owners**
5. **Comply with all applicable laws and regulations**

For more comprehensive testing, consider using established tools like:
- OWASP ZAP
- Burp Suite
- Nikto
- Nmap (with NSE scripts)
- Metasploit Framework (for authorized penetration testing)
